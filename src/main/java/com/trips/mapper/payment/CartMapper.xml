<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.trips.mapper.payment.CartMapper">
	<sql id="cartListSql">

		SELECT RES_NO resNo,
		M_ID id,
		B_NO boardBno,
		O_PRICE price,
		AMOUNT amount,
		CART_QTY cartQty,
		renamedFileName
		FROM CART;
	</sql>

	<resultMap type="com.trips.domain.payment.CartList" id="cartListResultMap">
		<id property="resNo" column="RES_NO"></id>
		<result property="id" column="M_ID" />
		<result property="boardBno" column="B_NO" />
		<result property="price" column="O_PRICE" />
		<result property="amount" column="AMOUNT" />
		<result property="cartQty" column="CART_QTY" />
		<result property="renamedFileName" column="renamedFileName" />
	</resultMap>

	<select id="cartList" parameterType="String"
		resultMap="cartListResultMap">

		SELECT c.RES_NO resNo,m.M_ID id,c.B_NO boardBno,O_PRICE price,AMOUNT
		amount,CART_QTY cartQty,renamedFileName
		from CART c
		LEFT JOIN MEMBER m on m.M_ID = c.RES_NO
		AND c.M_ID = m.M_ID
		left join ACTI_BOARD a
		on c.B_NO = a.B_NO
		where c.B_NO =
		a.B_NO;

	</select>

	<insert id="addCart">

		INSERT INTO CART(
		M_ID, 
		B_NO,
		PERSON,
		PRICE,
		ADDDATE
		)
		VALUES('aa',#{boardnum},#{person},#{price},#{addDate});


	</insert>

	<delete id="deleteCart">
		DELETE FROM cart WHERE RES_NO=#{resNo}
	</delete>

	<delete id="deleteAllCart">
		DELETE FROM cart WHERE M_ID=#{id}
	</delete>

</mapper>
	